<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Memory Card Flip Game</title>
  <style>
    body {
      font-family: sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      background: #f0f0f0;
      margin-top: 30px;
      perspective: 1000px;
      transition: background 0.5s, color 0.5s;
    }

    body.dark {
      background: #1e1e1e;
      color: white;
    }

    h1 {
      margin-bottom: 10px;
    }

    .info, .controls {
      margin-bottom: 20px;
    }

    .game-board {
      display: grid;
      gap: 10px;
      margin-bottom: 20px;
    }

    .card {
      width: 80px;
      height: 80px;
      perspective: 600px;
    }

    .card-inner {
      position: relative;
      width: 100%;
      height: 100%;
      transform-style: preserve-3d;
      transition: transform 0.6s;
      cursor: pointer;
      border-radius: 8px;
    }

    .card.flipped .card-inner {
      transform: rotateY(180deg);
    }

    .card-front, .card-back {
      position: absolute;
      width: 100%;
      height: 100%;
      backface-visibility: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 8px;
      font-size: 30px;
    }

    .card-front {
      background: #333;
      color: white;
    }

    .card-back {
      background: #fff;
      color: #333;
      transform: rotateY(180deg);
    }

    .card.matched .card-inner {
      background: linear-gradient(45deg, #00cc66, #00ff99);
      animation: sparkle 0.8s ease-out;
    }

    @keyframes sparkle {
      0% { transform: rotateY(180deg) scale(1); }
      50% { transform: rotateY(180deg) scale(1.2); }
      100% { transform: rotateY(180deg) scale(1); }
    }

    button, select {
      padding: 8px 16px;
      font-size: 16px;
      border: none;
      background: #007bff;
      color: white;
      border-radius: 5px;
      cursor: pointer;
      margin: 5px;
    }

    button:hover, select:hover {
      background: #0056b3;
    }

    select {
      margin-left: 10px;
    }
  </style>
</head>
<body>

<h1>ðŸ§  Memory Match!</h1>

<div class="controls">
  <label for="difficulty">Difficulty:</label>
  <select id="difficulty" onchange="restartGame()">
    <option value="easy">Easy (2x2)</option>
    <option value="normal" selected>Normal (4x4)</option>
    <option value="hard">Hard (6x6)</option>
  </select>
  <button onclick="toggleTheme()">ðŸŒ“ Toggle Theme</button>
</div>

<div class="info">
  <p>Flips: <span id="flips">0</span> | Time: <span id="timer">0</span> sec | Best Time: <span id="best-time">-</span> sec</p>
</div>

<div class="game-board" id="board"></div>

<p id="message"></p>
<button onclick="restartGame()">ðŸ”„ Restart Game</button>

<!-- Sound Effects -->
<audio id="flip-sound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg"></audio>
<audio id="match-sound" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>
<audio id="win-sound" src="https://actions.google.com/sounds/v1/cartoon/clang_and_wobble.ogg"></audio>

<!-- Background Music -->
<audio id="bg-music" src="https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Komiku/Its_time_for_adventure_/Komiku_-_10_-_The_great_quest.mp3" loop autoplay></audio>

<script>
  const allEmojis = ['ðŸŽ','ðŸŒ','ðŸ‡','ðŸ“','ðŸ’','ðŸ‰','ðŸ¥','ðŸ','ðŸ‘','ðŸ¥¥','ðŸˆ','ðŸ‹','ðŸŠ','ðŸ','ðŸ¥­','ðŸ¥•','ðŸŒ½','ðŸ…','ðŸ','ðŸ«','ðŸ«’'];
  let emojis = [];
  let cards = [];
  let flipped = [];
  let board = document.getElementById('board');
  let flips = 0;
  let timerInterval;
  let seconds = 0;
  let matchedPairs = 0;
  let totalPairs = 8;

  function shuffle(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
  }

  function createBoard() {
    board.innerHTML = '';
    cards = [];
    flipped = [];

    const difficulty = document.getElementById('difficulty').value;
    if (difficulty === 'easy') {
      board.style.gridTemplateColumns = 'repeat(2, 80px)';
      emojis = allEmojis.slice(0, 2);
      totalPairs = 2;
    } else if (difficulty === 'normal') {
      board.style.gridTemplateColumns = 'repeat(4, 80px)';
      emojis = allEmojis.slice(0, 8);
      totalPairs = 8;
    } else if (difficulty === 'hard') {
      board.style.gridTemplateColumns = 'repeat(6, 80px)';
      emojis = allEmojis.slice(0, 18);
      totalPairs = 18;
    }

    let emojiList = [...emojis, ...emojis];
    shuffle(emojiList);

    emojiList.forEach((emoji, index) => {
      const card = document.createElement('div');
      card.classList.add('card');
      card.dataset.emoji = emoji;
      card.dataset.index = index;

      const cardInner = document.createElement('div');
      cardInner.classList.add('card-inner');

      const front = document.createElement('div');
      front.classList.add('card-front');
      front.textContent = '?';

      const back = document.createElement('div');
      back.classList.add('card-back');
      back.textContent = emoji;

      cardInner.appendChild(front);
      cardInner.appendChild(back);
      card.appendChild(cardInner);

      card.addEventListener('click', flipCard);
      board.appendChild(card);
      cards.push(card);
    });
  }

  function startTimer() {
    timerInterval = setInterval(() => {
      seconds++;
      document.getElementById('timer').textContent = seconds;
    }, 1000);
  }

  function stopTimer() {
    clearInterval(timerInterval);
  }

  function flipCard() {
    if (this.classList.contains('flipped') || this.classList.contains('matched') || flipped.length === 2) return;

    document.getElementById('flip-sound').play();
    this.classList.add('flipped');
    flipped.push(this);
    flips++;
    document.getElementById('flips').textContent = flips;

    if (flips === 1) startTimer();

    if (flipped.length === 2) {
      const [card1, card2] = flipped;
      if (card1.dataset.emoji === card2.dataset.emoji) {
        card1.classList.add('matched');
        card2.classList.add('matched');
        matchedPairs++;
        flipped = [];
        document.getElementById('match-sound').play();

        if (matchedPairs === totalPairs) {
          stopTimer();
          document.getElementById('message').textContent = `ðŸŽ‰ You won in ${seconds} seconds with ${flips} flips!`;
          document.getElementById('win-sound').play();
          saveBestTime(seconds);
        }
      } else {
        setTimeout(() => {
          card1.classList.remove('flipped');
          card2.classList.remove('flipped');
          flipped = [];
        }, 800);
      }
    }
  }

  function restartGame() {
    stopTimer();
    seconds = 0;
    flips = 0;
    matchedPairs = 0;
    document.getElementById('timer').textContent = 0;
    document.getElementById('flips').textContent = 0;
    document.getElementById('message').textContent = '';
    createBoard();
    loadBestTime();
  }

  function saveBestTime(time) {
    const difficulty = document.getElementById('difficulty').value;
    let bestTimeKey = `bestTime-${difficulty}`;
    let bestTime = localStorage.getItem(bestTimeKey);
    if (!bestTime || time < bestTime) {
      localStorage.setItem(bestTimeKey, time);
      document.getElementById('best-time').textContent = time;
    }
  }

  function loadBestTime() {
    const difficulty = document.getElementById('difficulty').value;
    let bestTimeKey = `bestTime-${difficulty}`;
    let bestTime = localStorage.getItem(bestTimeKey);
    if (bestTime) {
      document.getElementById('best-time').textContent = bestTime;
    } else {
      document.getElementById('best-time').textContent = '-';
    }
  }

  function toggleTheme() {
    document.body.classList.toggle('dark');
  }

  document.getElementById('difficulty').addEventListener('change', loadBestTime);

  loadBestTime();
  createBoard();
</script>

</body>
</html>
